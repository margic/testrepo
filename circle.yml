machine:
  services:
    - docker

dependencies:
  override:
    - mkdir -p $CIRCLE_ARTIFACTS/out
    - docker run -it --rm --volume $CIRCLE_ARTIFACTS/out:/out pcrofts/goscratch build --package github.com/margic/testrepo
  post:
    - ls $CIRCLE_ARTIFACTS/out
    - $CIRCLE_ARTIFACTS/out/goapp

test:
  override:
    # run the tests and output a junit style report in the circle folder
    - mkdir -p $CIRCLE_TEST_REPORTS/junit
    - docker run -it --rm --volume $CIRCLE_TEST_REPORTS/junit:/results pcrofts/goscratch test --package github.com/margic/testrepo
